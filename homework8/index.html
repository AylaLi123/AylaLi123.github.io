<head>
<meta name="author" content="Ayla">
<title>Data Visualisation Homework 8</title>
 <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	
<script src="https://d3js.org/d3.v5.js"></script>	
 <script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>
	
</head>



<body>
<div class = "container">
<div class="jumbotron">
<h1>2016 Legislative Council Election</h1>
</div>
</div>

<div class="container">
<div class="row">
<div class="col-md-8" id="main">
<h1 style="text-align:center; font-size:26">2016 Legislative Council Election Turnout Rate in Geographical Constituencies<span class="small">(Percentage)</span></h1>
</div>
<div class="col-md-4" style="background-color: #bfbfbf">
<p>Among all the five geographical constituencies, Hong Kong Island has the highest cumulative turnout rate, which is 60.74%. 
<br>Kowloon East has the lowest cumulative turnout rate, which is 55.98%. 
<br>In 2016, the overall number of registered electors is 3,779,085. 
<br>The total number of voter turnout is 2,202,283, which the cumulative turnout rate is 58.28%.
</p>

</div>
</div>
	
<!-- bar chart -->
<svg id="chart1" height="500" width="500"></svg>

<script src="https://d3js.org/d3.v5.js"></script>	
<script src="https://d3js.org/d3.v4.min.js"></script>
<script type="text/javascript">
 
var dataset= [{
 "area":"Hong Kong Island",
 "rate":0.6074
},{
 "area":"Kowloon West",
 "rate":0.5813
},{
 "area":"Kowloon East",
  "rate":0.5598
},{
 "area":"New Territories West",
   "rate":0.5643
},{
"area":"New Territories",
 "rate":0.6024
}]
 
var margins={
            top: 50,
            right: 50,
            bottom: 100,
            left: 60
        }
var height = 400 - margins.left - margins.right,
    width = 800 - margins.top - margins.bottom,
    barPadding = 8
// Create a scale for the y-axis based on data
// >> Domain - min and max values in the dataset
// >> Range - physical range of the scale (reversed)
var yScale = d3.scaleLinear() // d3.scale.linear()
            .domain([0, d3.max(dataset, function(d) {
                return d.rate;
            })])
            .range([height, 0]);
// Implements the scale as an actual axis
// >> Orient - places the axis on the left of the graph
// >> Ticks - number of points on the axis, automated
// var yAxis = d3.svg.axis()
//     .scale(yScale)
//     .orient('left')
//     .ticks(6);
yAxis = d3.axisLeft()
            .scale(yScale)
            .ticks(10, "%");
        // Creates a scale for the x-axis based on city names
        var xScale = d3.scaleBand()
            .domain(dataset.map(function(d) {
                return d.area;
            }))
            .range([0, width])
            .round(.1);
        // Creates an axis based off the xScale properties
        var xAxis = d3.axisBottom()
            .scale(xScale);
        var color = d3.scaleOrdinal(d3.schemeCategory20);
        // Creates the initial space for the chart
        // >> Select - grabs the empty <div> above this script
        // >> Append - places an <svg> wrapper inside the div
        // >> Attr - applies our height & width values from above
        var chart = d3.select('#chart1')
            .append('svg')
            .attr('width', width + margins.left + margins.right)
            .attr('height', height + margins.top + margins.bottom)
            .append('g')
            .attr('transform', 'translate(' + margins.left + ',' + margins.top + ')');
        // For each value in our dataset, places and styles a bar on the chart
        // Step 1: selectAll.data.enter.append
        // >> Loops through the dataset and appends a rectangle for each value
        chart.selectAll('rect')
            .data(dataset)
            .enter()
            .append('rect')
        // Step 2: X & Y
        // >> X - Places the bars in horizontal order, based on number of
        //        points & the width of the chart
        // >> Y - Places vertically based on scale
        .attr('x', function(d, i) {
                return xScale(d.area);
            })
            .attr('y', function(d) {
                return yScale(d.rate);
            })
        // Step 3: Height & Width
        // >> Width - Based on barpadding and number of points in dataset
        // >> Height - Scale and height of the chart area
        .attr('width', (width / dataset.length) - barPadding)
            .attr('height', function(d) {
                return height - yScale(d.rate);
            })
            .attr("fill", function(d, i) {
                return color(i);
            });
        // .attr('fill', 'steelblue')
        // Step 4: Info for hover interaction
        //.attr('class', function(d){
        //    return d.area;
        //  })
        //.attr('id', function(d){
        // return d.rate.ticks(10, "%");
        //});
        // Renders the yAxis once the chart is finished
        // >> Moves it to the left 10 pixels so it doesn't overlap
        chart.append('g')
            .attr('class', 'axis')
            .attr('transform', 'translate(-10, 0)')
            .call(yAxis);
        // Appends the yAxis
        chart.append('g')
            .attr('class', 'axis')
            .attr('transform', 'translate(0,' + (height + 10) + ')')
            .call(xAxis);
        // Adds yAxis title
        chart.append('text')
            .text('Revenue in billions')
            .attr('transform', 'translate(-60, -20)');
        // .style("font-family","Sans-serif")
        chart.selectAll("annotation")
            .data(dataset)
            .enter()
            .append("text")
            .attr("class", "annotation")
            .text(function(d) {
                return d.rate;
            })
            .attr("x", function(d) {
                return xScale(d.area) + 40
            })
            .attr("y", function(d) {
                return yScale(d.rate) - 10;
            })
            .style("fill", "black");
        // $(function() {
        //     // On document load, call the render() function to load the graph
        //     render();
        //     $('rect').mouseenter(function() {
        //         $('#city').html(this.className.animVal);
        //         $('#inches').html($(this).attr('id'));
        //     });
    </script>
	
	
<!-- pie chart -->
<script src="//d3js.org/d3.v4.min.js"></script>

    <link rel="stylesheet" href="sequences.css" />
	 <div class="main">
         <h1>Age Group and Sex of Voter Turnout by Geographical Constituency in 2016 Legislative Council Selection</h1>
        <h3>Here are two charts shows where the money goes, raw data are from government website. Though these data are not user-friendly, when you try to group them into ten big categories(support,affairs,economic,education,environment,health,housing,infrastructure,security,welfare).</h3>
        <h3>What I am trying to do here is classifying the detailed spendings into ten categories, according to two given elements: the bureau which spend the money, the exact percentages of each categories. After a lot of guessing and assisting from speclists, I control the error percentages under 0.5%, and here are the demo just for reference. </h3>

        <div id="sequence"></div>
        <div id="chart">
            <div id="explanation" style="visibility: hidden;">
                <span id="percentage"></span><br/> 
                of Voter Turnout in 2016 Legislative Council Selection


            </div>
        </div>
    </div>
    <div class="sidebar">
        <input type="checkbox" id="togglelegend"> Sex<br/>
        <div id="legend" style="visibility: hidden;"></div>
    </div>

    <script type="text/javascript" src="sequences.js"></script>
    <script type="text/javascript">
        // Hack to make this example display correctly in an iframe on bl.ocks.org
        d3.select(self.frameElement).style("height", "700px");
    </script>
<!-- bubble chart -->
	
<script src="https://d3js.org/d3.v5.js"></script>

    <script src="https://d3js.org/d3-array.v1.min.js"></script>
    <script src="https://d3js.org/d3-collection.v1.min.js"></script>
    <script src="https://d3js.org/d3-color.v1.min.js"></script>
    <script src="https://d3js.org/d3-format.v1.min.js"></script>
    <script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
    <script src="https://d3js.org/d3-time.v1.min.js"></script>
    <script src="https://d3js.org/d3-time-format.v2.min.js"></script>
    <script src="https://d3js.org/d3-scale.v2.min.js"></script>
<div class="main">
<div id="chart">

    <h1> 2016 Legislative Council Election Age Group and Sex of Voter Turnout by Geographical Constituency</h1>

	
    <svg id= "chart2" width="5000"  height="5000" x="10" y="10"></svg>
	</div>
	</div>

    <script>
        var x = d3.scaleLinear()
            .domain([1000, 40000]) //range of  your raw data
            .range([0, 500]); //range of svg coordinates
        var y = d3.scaleLinear()
            .domain([1000, 45000])//range of  your raw data
            .range([500, 0]); //range of svg coordinates
        var xAxis = d3.axisBottom().scale(x);
        var yAxis = d3.axisLeft().scale(y);
        var svg = d3.select('#chart2');
        //svg.remove.();
        
        svg.append('g')
            .attr("class", "axis")
            .attr('transform', 'translate(40,500)') //translate(x,y)
            //.attr("transform", "translate(" + x + "," + y + ")")
            //.attr('transform', 'translate(' + padding.left + ',' + (height - padding.bottom) + ')')
            .call(xAxis);
        
//         svg.append("g")
//     .attr("class", "axis")
//     .attr("transform", "translate(" + x + "," + y + ")")
//     .call(xAxis);
        svg.append('g')
            //.attr('class','axis')
            .attr('transform', 'translate(40,0)') //translate(x,y)
            .call(yAxis);
      
        var dataset = [
            [18-20, [{
                'male': 4993,
                'female': 4736,
            }, {
                'male': 4088,
                'female': 3865,
            }, {
                'male': 5871,
                'female': 5756,
            }, {
                'male': 11138,
                'female': 10383,
            }, {
                'male': 10759,
                'female': 10250,
            }, ]],
            [21-25, [{
                'male': 10071,
                'female': 10078,
            }, {
                'male': 8204,
                'female': 7937,
            }, {
                'male': 11585,
                'female': 11119,
            }, {
                'male': 23184,
                'female': 22190,
            }, {
                'male': 22279,
                'female': 21403,
            }, ]],
            [26-30, [{
                'male': 11241,
                'female': 11279,
            }, {
                'male': 8778,
                'female': 8524,
            }, {
                'male': 10979,
                'female': 9986,
            }, {
                'male': 22296,
                'female': 21031,
            }, {
                'male': 23498,
                'female': 22576,
            }, ]],
          [31-35, [{
                'male': 11883,
                'female': 11871 ,
            }, {
                'male': 9693,
                'female': 9106,
            }, {
                'male': 10686,
                'female':9757,
            }, {
                'male': 22563,
                'female': 21607,
            }, {
                'male': 23894,
                'female': 22763,
            }, ]],
          [36-40, [{
                'male': 12837,
                'female':13547 ,
            }, {
                'male': 10260,
                'female': 10298,
            }, {
                'male': 10860,
                'female':10333,
            }, {
                'male': 22824,
                'female': 22381,
            }, {
                'male': 21097,
                'female': 21296,
            }, ]],
          [41-45, [{
                'male': 14760,
                'female':16818 ,
            }, {
                'male': 12077,
                'female':12890,
            }, {
                'male': 12004,
                'female':12815,
            }, {
                'male': 23298,
                'female': 25150,
            }, {
                'male':21133,
                'female': 23762,
            }, ]],
          [46-50, [{
                'male': 16626,
                'female':19225 ,
            }, {
                'male':12703,
                'female':13730,
            }, {
                'male': 14025,
                'female':15737,
            }, {
                'male': 25514,
                'female': 30202,
            }, {
                'male':23633,
                'female': 28375,
            }, ]],
          [51-55, [{
                'male': 20970,
                'female':23873 ,
            }, {
                'male':14127,
                'female':15297,
            }, {
                'male': 17839,
                'female':19775,
            }, {
                'male': 33717,
                'female': 37737,
            }, {
                'male':32735,
                'female': 37342,
            }, ]],
          [56-60, [{
                'male': 22163,
                'female':23789,
            }, {
                'male':15310,
                'female':15619,
            }, {
                'male': 18296,
                'female':19338,
            }, {
                'male': 37074,
                'female': 36443,
            }, {
                'male':37294,
                'female': 37438,
            }, ]],
          [61-65, [{
                'male': 19387,
                'female':20009,
            }, {
                'male':13406,
                'female':13884,
            }, {
                'male': 14890,
                'female':15914,
            }, {
                'male': 30077,
                'female': 28770,
            }, {
                'male':28866,
                'female': 27367,
            }, ]],
          [66-70, [{
                'male': 17251,
                'female':16835,
            }, {
                'male':12152,
                'female':12566,
            }, {
                'male': 14890,
                'female':15914,
            }, {
                'male': 13426,
                'female': 14197,
            }, {
                'male':22188,
                'female': 19012,
            }, ]],
          [71, [{
                'male': 24612,
                'female':22375,
            }, {
                'male':20659,
                'female':18462,
            }, {
                'male': 26267,
                'female':25123,
            }, {
                'male': 33285,
                'female': 26845,
            }, {
                'male':26593,
                'female': 21626,
            }, ]],
        ];
        var frameHeight = 150;
        svg
            .selectAll('circle')
            .data(dataset[0][1])
            .enter()
            .append('circle')
            .attr('cx', function(d) {
                return x(d['male']);
            })
            .attr('cy', function(d) {
                return y(d['female']);
                //return frameHeight - d['female'];
            })
            .attr('r', function(d) {
                //return d['female'] / 10;
                return Math.sqrt(d['female']);
            })
            .attr('fill', '#FF0000')
        .style({
		stroke: 'green', 
		'stroke-width': 5, 
		opacity: .5
	});
        
            //.attr('transform', function(d) {return 'translate(' + (xScale(d[0]) + padding.left) + ',' + (yScale(d[1]) + padding.top) + ')'});
        
        
        var keySnapshot = 0;
        d3.interval(function() {
            keySnapshot = (keySnapshot + 1) % dataset.length;
            
            svg
                .selectAll('circle')
                .data(dataset[keySnapshot][1])
                .transition()
                .duration(1000)
                .attr('cx', function(d) {
                    return x(d['male']);
                })
                .attr('cy', function(d) {
                    return y(d['female']);
                    //return frameHeight - d['female'];
                })
                .attr('r', function(d) {
                    return d['female'] / 1000;
                    //return Math.sqrt(d['female']);
                })
                .attr('fill', '#8000ff')
            .style({
		stroke: 'green', 
		'stroke-width': 5, 
		opacity: .5
	})
        }, 1000)
    </script>




    <!-- svg.append('circle').attr('cx', 170).attr('cy', 70).attr('r', 10); 
        svg.append('circle').attr('cx', 160).attr('cy', 50).attr('r', 10); 
        svg.append('circle').attr('cx', 180).attr('cy', 70).attr('r', 10); 
        svg.append('circle').attr('cx', 180).attr('cy',
        80).attr('r', 10); 
        <script> -->
    <!--    var svg = d3.select('svg');
                 svg.remove.();
             var data = [{
                         'height': 170,
                         'weight': 70,
    
                }, {
                      'height': 160,
                      'weight': 50,
    
                  }, {
                     'height': 180,
                     'weight': 70,
    
                   }, {
                      'height': 180,
                    'weight': 80,
    
              }
    
               ];
    
                var frameHeight = 150;
               for (i = 0; i < data.length; i++) {
                    i = 0;
                   var x = data[i]['height'];
                    var y = frameHeight - data[i]['wieght'];
                   svg.append('circle').attr('cx', x).attr('cy', y).attr('r', 5);
                }
            -->

</body>
	</body>

